% -*- coding: UTF-8 -*-
\documentclass[UTF8]{ctexart}
\usepackage[dvipsnames]{xcolor}
\usepackage{graphicx}
\graphicspath{{./images/}}
\usepackage{courier}
\usepackage{listings}
\lstset{
    tabsize = 4, %% set tab space width
    showstringspaces = false, %% prevent space marking in strings, string is defined as the text that is generally printed directly to the console
    numbers = left, %% display line numbers on the left
    commentstyle = \color{green}, %% set comment color
    keywordstyle = \color{blue}, %% set keyword color
    stringstyle = \color{red}, %% set string color
    rulecolor = \color{black}, %% set frame color to avoid being affected by text color
    basicstyle = \small \ttfamily, %% set listing font and size
    breaklines = true, %% enable line breaking
    numberstyle = \tiny,
}
% from https://tex.stackexchange.com/questions/437646/lstlisting-format-java-code
\usepackage{fancyhdr}
\pagestyle{fancy}
\lhead{\includegraphics[width=0.2\textwidth]{school_name.png}}
\rhead{作业报告} 

% from https://blog.csdn.net/u010801696/article/details/78868605
\begin{document}

\begin{titlepage}
    \begin{center}
        \Huge{作业报告}
        \noindent{\color{BrickRed} \rule{\linewidth}{1mm}}
        \Huge
        \vspace{0.5cm}
		\LARGE
		\vspace{1.5cm}
		\textbf{}

        % the blank line above shouldn't be deleted
        \includegraphics[width=0.4\textwidth]{school_emblem.png}

        \vspace{1.5cm}
    \end{center}
    \Large
    \begin{tabbing}
        \hspace*{1em}\= \hspace*{8em} \= \kill % set the tabbings
        \> 姓名 \>  \textbf{博丽灵梦} \\
        \> 班级 \>  软件1996 \\
        \> 学号 \>  114514114514  \\
        \> 电话  \> 114514114 \\
        \> Email \> 114514114@touhou.com \\
        \> 日期 \>  1995{-}2{-}7
    \end{tabbing}
    
\end{titlepage}
\setlength{\headheight}{21.89642pt}
\tableofcontents
\newpage{}
\section{数据设计}
\section{算法设计}
\section{主干代码展示}
\section{运行结果}
\section{总结与收获}
\newpage
\appendix
\section{附录：源代码}
\subsection{Factorial.java}
\begin{lstlisting}[language = Java , frame = trBL , firstnumber = last , escapeinside={(*@}{@*)}]
    public class Factorial {
    public static void main(String[] args) {   
        final int NUM_FACTS = 100;
        for(int i = 0; i < NUM_FACTS; i++)
            System.out.println( i + "! is " + factorial(i));
    }

    public static int factorial(int n) {
        int result = 1;
        for(int i = 2; i <= n; i++) (*@\label{for}@*)
            result *= i;
        return result;
    }
}
\end{lstlisting}
\end{document}